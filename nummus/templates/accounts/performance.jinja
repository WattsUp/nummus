<div class="w-full h-60 md:h-96 relative">
    <canvas id="account-chart-canvas" hx-preserve></canvas>
    <div id="account-indicator" class="spinner-overlay">{% include "shared/spinner.jinja" %}</div>
</div>
{% with perf = acct.performance %}
    <script>accounts.update(JSON.parse('{{ perf | tojson }}'))</script>
    <div class="flex gap-2 justify-around"
         hx-target="#account-performance"
         hx-indicator="#account-indicator">
        {% for value, label in perf.period_options.items() %}
            {% set btn_class = "btn-tonal" if value == perf.period else "btn-text" %}
            <button class="{{ btn_class }}"
                    hx-get="{{ url_for('accounts.performance', uri=acct.uri, chart_period=value) }}">
                {{ label }}
            </button>
        {% endfor %}
    </div>
    <h1 class="text-2xl font-serif text-primary">Performance</h1>
    <div class="bg-surface-container-high rounded-xl p-2 grid grid-cols-2 max-w-md mx-auto font-bold">
        <div class="text-on-surface-variant">Total Return</div>
        <div class="{{ perf.pnl_total | pnl_color }} flex justify-end items-center">
            <icon class="sm">{{ perf.pnl_total | pnl_arrow }}</icon>
            {{ perf.pnl_total | abs | money }}
        </div>
        <hr>
        <div class="text-on-surface-variant">Contributions</div>
        <div class="text-right">{{ perf.total_cost_basis | money }}</div>
        <div class="text-on-surface-variant">Dividends earned</div>
        <div class="text-right">{{ perf.dividends | money }}</div>
        <div class="text-on-surface-variant">Investment fees</div>
        <div class="text-right">{{ perf.fees | money }}</div>
        <div class="text-on-surface-variant">Uninvested cash</div>
        <div class="text-right">{{ perf.cash | money }}</div>
        <hr>
        <div class="text-on-surface-variant font-normal col-span-full text-center italic">Over selected period</div>
        <div class="text-on-surface-variant">TWRR per annum</div>
        <div class="text-right">{{ perf.twrr | percent }}</div>
        <div class="text-on-surface-variant">MWRR per annum</div>
        <div class="text-right">{{ perf.mwrr | percent }}</div>
    </div>
{% endwith %}
