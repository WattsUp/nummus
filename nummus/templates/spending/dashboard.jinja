<div
  hx-target="#main"
  hx-swap="innerHTML show:window:top"
  hx-push-url="true"
  class="row-span-2"
>
  {% set n_display = 8 %}
  <a
    href="{{ url_for("spending.page") }}"
    hx-get="{{ url_for("spending.page") }}"
    hx-disabled-elt="this"
  >
    <h1>Spending {{ ctx.selected_period }}</h1>
    <icon>chevron_forward</icon>
  </a>
  <details class="mb-2 rounded-md" name="spending-by">
    <summary
      class="bg-primary-container flex items-center gap-2 rounded-md p-2"
    >
      <icon>account_balance</icon>
      <span class="mr-auto">By account</span>
      <icon class="details-icon-open">keyboard_arrow_up</icon>
      <icon class="details-icon-closed">keyboard_arrow_down</icon>
    </summary>
    {% for label, amount in ctx.by_account[:n_display] %}
      <div
        class="even:bg-surface-container-highest flex justify-between gap-2 rounded-md px-2 py-1"
      >
        <div class="truncate">{{ label }}</div>
        <div class="shrink-0">{{ -amount | money }}</div>
      </div>
    {% endfor %}
  </details>
  <details class="mb-2 rounded-md" name="spending-by">
    <summary
      class="bg-primary-container flex items-center gap-2 rounded-md p-2"
    >
      <icon>store</icon>
      <span class="mr-auto">By payee</span>
      <icon class="details-icon-open">keyboard_arrow_up</icon>
      <icon class="details-icon-closed">keyboard_arrow_down</icon>
    </summary>
    {% for label, amount in ctx.by_payee[:n_display] %}
      <div
        class="even:bg-surface-container-highest flex justify-between gap-2 rounded-md px-2 py-1"
      >
        <div class="truncate">{{ label }}</div>
        <div class="shrink-0">{{ -amount | money }}</div>
      </div>
    {% endfor %}
  </details>
  <details class="mb-2 rounded-md" name="spending-by" open>
    <summary
      class="bg-primary-container flex items-center gap-2 rounded-md p-2"
    >
      <icon>category</icon>
      <span class="mr-auto">By category</span>
      <icon class="details-icon-open">keyboard_arrow_up</icon>
      <icon class="details-icon-closed">keyboard_arrow_down</icon>
    </summary>
    {% for label, amount in ctx.by_category[:n_display] %}
      <div
        class="even:bg-surface-container-highest flex justify-between gap-2 rounded-md px-2 py-1"
      >
        <div class="truncate">{{ label }}</div>
        <div class="shrink-0">{{ -amount | money }}</div>
      </div>
    {% endfor %}
  </details>
  <details class="mb-2 rounded-md" name="spending-by">
    <summary
      class="bg-primary-container flex items-center gap-2 rounded-md p-2"
    >
      <icon>label</icon>
      <span class="mr-auto">By tag</span>
      <icon class="details-icon-open">keyboard_arrow_up</icon>
      <icon class="details-icon-closed">keyboard_arrow_down</icon>
    </summary>
    {% for label, amount in ctx.by_tag[:n_display] %}
      <div
        class="even:bg-surface-container-highest flex justify-between gap-2 rounded-md px-2 py-1"
      >
        <div class="truncate">{{ label or "[none]" }}</div>
        <div class="shrink-0">{{ -amount | money }}</div>
      </div>
    {% endfor %}
  </details>
  <i class="text-center text-sm">
    top {{ n_display }} spending locations year-to-date
  </i>
</div>
