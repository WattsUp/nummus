@custom-variant open (&:where(.open, .open *));
@custom-variant nav-current (&:where(.nav-current, .nav-current *));

@utility nav-section {
    @apply flex items-center;

    &>h1 {
        @apply px-3 border border-transparent w-full;
    }

    &>button,
    &>a {
        @apply w-min mx-auto btn-text-green relative;

        @variant nav-current {
            @apply btn-tonal-green font-bold;

            &>icon {
                font-variation-settings: 'FILL' 1;
            }
        }

        @variant not-nav-current {
            @apply text-grey-900 dark:text-white;
        }

    }

}

@utility nav-rail {
    @apply w-24 h-full shrink-0 flex flex-col p-1 overflow-y-auto;
    @apply fixed left-0;
    @apply bg-grey-100 dark:bg-grey-900 not-dark:text-grey-900;

    &>* {
        @apply shrink-0;
    }

    &>a {
        @apply hidden md:flex flex-col justify-end mx-auto h-12;
        @apply cursor-pointer font-title text-xl;
        @apply hover:text-green-900 active:text-green-900 transition-colors;

        @variant dark {
            @apply hover:text-green-200 active:text-green-200;
        }
    }

    &>section {
        @apply nav-section;
        @apply flex-col gap-1 py-1;

        @variant first-of-type {
            @apply my-8;
        }

        @variant last-of-type {
            @apply grow;
        }

    }
}

@layer components {
    #nav-rail {
        @apply nav-rail max-md:hidden lg:hidden;

        &>section>button,
        &>section>a {
            @apply btn-stacked;
        }
    }

    #nav-drawer {
        @apply nav-rail w-52 px-2;

        /* Modal nav-drawer */
        @variant max-lg {
            @apply fixed top-0 z-50 rounded-r-3xl;
            @apply transition-transform -translate-x-full duration-300;

            @variant open {
                @apply translate-x-0;

                &~#scrim {
                    @apply translate-x-0 opacity-100;
                    transition: opacity 0.3s, translate 0s;
                }
            }
        }

        &>a {
            @apply text-5xl;
        }

        &>section>button,
        &>section>a {
            @apply p-3 w-full;
        }
    }

    #nav-bar {
        @apply nav-section;
        @apply w-full fixed bottom-0 pt-2 md:hidden justify-evenly;
        @apply bg-grey-100 dark:bg-grey-900 not-dark:text-grey-900;

        transition: translate 0.5s;

        &>button,
        &>a {
            @apply btn-stacked btn-size-lg last:w-min mx-0;

            @variant last {
                @apply w-min absolute right-3 bottom-19.5;
                @apply fab-green;
                transition: translate 0.5s;
            }
        }
    }

    #nav-header {
        @apply w-full fixed top-0 z-40 md:hidden;
        @apply bg-green-600 dark:bg-green-400 text-white dark:text-green-900;

        transition: translate 0.5s;

        &>* {
            @apply cursor-pointer;
            @apply hover:text-green-900 active:text-green-900 transition-colors;

            @variant dark {
                @apply hover:text-green-100 active:text-green-100;
            }
        }

        &>icon {
            @apply absolute text-[36px] p-0.5;
        }

        &>a {
            @apply block w-min px-2;
            @apply font-title text-4xl mx-auto;
        }
    }

    #nav-footer {
        @apply fixed w-full h-28 p-2 bottom-0;
        @apply bg-green-300 dark:bg-grey-950 border-green-800 dark:border-green-900;
        @apply border-t-4 text-left md:text-center text-sm;
    }
}
